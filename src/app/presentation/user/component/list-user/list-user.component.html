<div class="container">
    @if (loading) {
        <div class="loading-container">
            <mat-spinner [diameter]="50"></mat-spinner>
        </div>
    } @else {
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title text-uppercase mb-0">Manage Users</h5>
                    </div>
                    <div class="table-responsive">
                        <!-- Search Field -->
                        <div class="search-container">
                            <mat-form-field class="search-field" appearance="outline">
                                <mat-label>Search</mat-label>
                                <input matInput [(ngModel)]="searchValue" (input)="onSearch()"
                                    placeholder="Search name user" />
                                <button mat-icon-button matSuffix (click)="onSearch()">
                                    <mat-icon>search</mat-icon>
                                </button>
                            </mat-form-field>
                        </div>

                        <!-- User Table -->
                        <table class="table no-wrap user-table mb-0">
                            <thead>
                                <tr>
                                    <th scope="col" class="border-0 text-uppercase font-medium pl-4">#</th>
                                    <th scope="col" class="border-0 text-uppercase font-medium">Avatar</th>
                                    <th scope="col" class="border-0 text-uppercase font-medium">Name</th>
                                    <th scope="col" class="border-0 text-uppercase font-medium">Email</th>
                                    <th scope="col" class="border-0 text-uppercase font-medium">Manage</th>
                                </tr>
                            </thead>
                            <tbody>
                                @for (user of users?.data; track user.id) {
                                <tr (click)="openUserProfileDialog(user)" style="cursor: pointer;">
                                    <td class="pl-4">{{ user.id }}</td>
                                    <td>
                                        <!-- Avatar as Icon -->
                                        <img [src]="user.avatar" alt="{{ user.first_name }}'s avatar" class="avatar-icon">
                                    </td>
                                    <td>
                                        <h5 class="font-medium mb-0">{{ user.first_name }} {{ user.last_name }}</h5>
                                    </td>
                                    <td>
                                        <span class="text-muted">{{ user.email }}</span>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-outline-info btn-circle btn-lg btn-circle" (click)="$event.stopPropagation()">
                                            <i class="fa fa-key"></i>
                                        </button>
                                        <button type="button"
                                            class="btn btn-outline-info btn-circle btn-lg btn-circle ml-2" (click)="$event.stopPropagation()">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                        <button type="button"
                                            class="btn btn-outline-info btn-circle btn-lg btn-circle ml-2" (click)="$event.stopPropagation()">
                                            <i class="fa fa-edit"></i>
                                        </button>
                                        <button type="button"
                                            class="btn btn-outline-info btn-circle btn-lg btn-circle ml-2" (click)="$event.stopPropagation()">
                                            <i class="fa fa-upload"></i>
                                        </button>
                                    </td>
                                </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    <div class="d-flex justify-content-between p-2">
                        <button mat-button (click)="previousPage()" [disabled]="currentPage === 1">Previous</button>
                        <span>Page {{ currentPage }} of {{ totalPages }}</span>
                        <button mat-button (click)="nextPage()" [disabled]="currentPage === totalPages">Next</button>
                    </div>
                </div>
            </div>
        </div>
    }
</div>